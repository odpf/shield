[request_definition]
r = sub, obj, act

[policy_definition]
p = sub, obj, act


[role_definition]
g = _, _, _
g2 = _, _, _
g3 = _, _, _

[policy_effect]
e = some(where (p.eft == allow))

[matchers]
m = g('user/' + r.sub, p.sub, 'user-team') \
&& ( g2(r.obj, p.obj, 'resource-project') || keyMatch2(r.obj, p.obj, 'resource-project') ) \
&& ( g3('permission/' + r.act, p.act, 'permission-role') || keyMatch2('permission/' + r.act, p.act, 'permission-role') )
